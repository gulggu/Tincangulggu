<!DOCTYPE html>
<html lang="ko">
<head>
 <meta charset="UTF-8">
 <meta name="viewport" content="width=device-width, initial-scale=1.0">
 <title>텍스트 → 이미지 변환기</title>
 <script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>
 <script src="https://cdn.jsdelivr.net/npm/@jaames/iro@5"></script>
 <script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/js/all.min.js"></script>
 <style>
 /* 폰트 설정 */
 @font-face {
 font-family: '부크크명조';
 src: url('https://fastly.jsdelivr.net/gh/projectnoonnu/noonfonts_2302@1.0/BookkMyungjo-Bd.woff2') format('woff2');
 font-weight: 700;
 font-style: normal;
 }
 @font-face {
 font-family: '조선일보명조';
 src: url('https://fastly.jsdelivr.net/gh/projectnoonnu/noonfonts_one@1.0/Chosunilbo_myungjo.woff') format('woff');
 font-weight: normal;
 font-style: normal;
 }
 @font-face {
 font-family: '조선가는고딕';
 src: url('https://fastly.jsdelivr.net/gh/projectnoonnu/noonfonts_20-04@1.0/ChosunSg.woff') format('woff');
 font-weight: normal;
 font-style: normal;
 }
 @font-face {
 font-family: '경기천년바탕';
 src: url('https://fastly.jsdelivr.net/gh/projectnoonnu/2410-3@1.0/Batang_Regular.woff') format('woff');
 font-weight: 400;
 font-style: normal;
 }
 @font-face {
 font-family: '수트';
 src: url('https://fastly.jsdelivr.net/gh/projectnoonnu/noonfonts_suit@1.0/SUIT-Regular.woff2') format('woff2');
 font-weight: normal;
 font-style: normal;
 }
 @font-face {
 font-family: '리디바탕';
 src: url('https://fastly.jsdelivr.net/gh/projectnoonnu/noonfonts_twelve@1.0/RIDIBatang.woff') format('woff');
 font-weight: normal;
 font-style: normal;
 }
 @font-face {
 font-family: '조선굴림체';
 src: url('https://fastly.jsdelivr.net/gh/projectnoonnu/noonfonts_20-04@1.0/ChosunGu.woff') format('woff');
 font-weight: normal;
 font-style: normal;
 }

 :root {
 --bg-color: #f4f4f4;
 --text-color: #333;
 --card-bg: white;
 --card-shadow: 0 2px 5px rgba(0,0,0,0.1);
 --border-color: #ddd;
 --primary-color: #4CAF50;
 --primary-hover: #3e8e41;
 --tab-color: #ddd;
 }

 [data-theme="dark"] {
 --bg-color: #121212;
 --text-color: #e0e0e0;
 --card-bg: #1e1e1e;
 --card-shadow: 0 2px 5px rgba(0,0,0,0.3);
 --border-color: #333;
 --primary-color: #5cbb60;
 --primary-hover: #4ca851;
 --tab-color: #333;
 }

 body {
 font-family: 'Noto Sans KR', sans-serif;
 text-align: center;
 background-color: var(--bg-color);
 color: var(--text-color);
 max-width: 1200px;
 margin: 0 auto;
 padding: 20px;
 transition: background-color 0.3s, color 0.3s;
 }

 h1, h2, h3 {
 color: var(--text-color);
 }

 .container {
 display: flex;
 flex-direction: column;
 gap: 20px;
 }

 .controls {
 display: flex;
 flex-wrap: wrap;
 gap: 20px;
 justify-content: center;
 }

 .control-group {
 background: var(--card-bg);
 padding: 15px;
 border-radius: 8px;
 box-shadow: var(--card-shadow);
 width: 100%;
 max-width: 450px;
 }

 .color-picker-container {
 margin: 0 auto;
 width: 200px;
 }

 textarea {
 width: 100%;
 height: 200px;
 padding: 10px;
 border: 1px solid var(--border-color);
 border-radius: 4px;
 font-family: inherit;
 font-size: 16px;
 resize: vertical;
 background-color: var(--card-bg);
 color: var(--text-color);
 overflow: auto;
 box-sizing: border-box;
 }

 .image-options {
 display: flex;
 flex-direction: column;
 gap: 10px;
 }

 .preview-container {
 position: relative;
 width: 100%;
 max-width: 600px;
 margin: 0 auto;
 overflow: hidden;
 }

 .slider-container {
 display: flex;
 overflow-x: hidden;
 scroll-behavior: smooth;
 width: 100%;
 position: relative;
 }

 .slider-controls {
 display: flex;
 justify-content: space-between;
 width: 100%;
 position: absolute;
 top: 50%;
 transform: translateY(-50%);
 z-index: 10;
 }

 .slider-arrow {
 background-color: rgba(0,0,0,0.3);
 color: white;
 border: none;
 border-radius: 50%;
 width: 40px;
 height: 40px;
 display: flex;
 justify-content: center;
 align-items: center;
 cursor: pointer;
 font-size: 18px;
 }

 .slider-dots {
 display: flex;
 justify-content: center;
 gap: 5px;
 margin-top: 10px;
 }

 .slider-dot {
 width: 10px;
 height: 10px;
 background-color: var(--border-color);
 border-radius: 50%;
 cursor: pointer;
 }

 .slider-dot.active {
 background-color: var(--primary-color);
 }

 .output-container {
 flex: 0 0 100%;
 scroll-snap-align: start;
 position: relative;
 }

 .image-preview {
 width: 100%;
 aspect-ratio: 9/16;
 position: relative;
 overflow: hidden;
 box-shadow: var(--card-shadow);
 display: flex;
 justify-content: center;
 align-items: center;
 }

 .text-box {
 background-color: white;
 width: 80%;
 height: auto;
 margin: 0 auto;
 padding: 30px 40px;
 box-shadow: 0 2px 10px rgba(0,0,0,0.1);
 position: relative;
 z-index: 2;
 font-family: '부크크명조', serif;
 }

 .preview-text {
 font-size: 16px;
 line-height: 1.8;
 text-align: left;
 word-break: keep-all;
 overflow-wrap: break-word;
 }

 .header-image {
 position: absolute;
 top: 0;
 left: 0;
 width: 100%;
 height: 100%;
 object-fit: cover;
 z-index: 1;
 }

 .button {
 background-color: var(--primary-color);
 color: white;
 border: none;
 padding: 10px 20px;
 border-radius: 4px;
 cursor: pointer;
 font-size: 16px;
 transition: background-color 0.3s;
 }

 .button:hover {
 background-color: var(--primary-hover);
 }

 .tab-buttons {
 display: flex;
 gap: 5px;
 margin-bottom: 10px;
 }

 .tab-button {
 padding: 8px 15px;
 border: none;
 background-color: var(--tab-color);
 cursor: pointer;
 border-radius: 4px 4px 0 0;
 color: var(--text-color);
 }

 .tab-button.active {
 background-color: var(--primary-color);
 color: white;
 }

 .file-input {
 display: none;
 }

 .file-label {
 background-color: var(--card-bg);
 border: 1px solid var(--border-color);
 padding: 10px;
 border-radius: 4px;
 cursor: pointer;
 display: inline-block;
 color: var(--text-color);
 }

 #imagePreview {
 width: 100%;
 max-height: 150px;
 object-fit: cover;
 margin-top: 10px;
 display: none;
 border-radius: 4px;
 }

 .theme-switch {
 position: fixed;
 top: 20px;
 right: 20px;
 width: 40px;
 height: 40px;
 border-radius: 50%;
 background-color: var(--card-bg);
 display: flex;
 justify-content: center;
 align-items: center;
 cursor: pointer;
 box-shadow: var(--card-shadow);
 z-index: 1000;
 }

 .theme-icon {
 font-size: 20px;
 color: var(--text-color);
 }

 .bg-settings-container {
 display: flex;
 flex-direction: row;
 flex-wrap: wrap;
 gap: 15px;
 }

 .bg-column {
 flex: 1;
 min-width: 200px;
 }

 select, input[type="color"] {
 background-color: var(--card-bg);
 color: var(--text-color);
 border: 1px solid var(--border-color);
 padding: 8px;
 border-radius: 4px;
 }

 input[type="range"] {
 width: 100%;
 }

 .setting-group {
 margin-bottom: 15px;
 border-bottom: 1px solid var(--border-color);
 padding-bottom: 15px;
 }

 .setting-group:last-child {
 border-bottom: none;
 margin-bottom: 0;
 }

 .setting-row {
 display: flex;
 justify-content: space-between;
 align-items: center;
 margin-bottom: 10px;
 }

 .setting-label {
 flex: 1;
 text-align: left;
 }

 .setting-control {
 flex: 1;
 }

 @media (max-width: 768px) {
 .control-group {
 max-width: 100%;
 }

 .text-box {
 width: 85%;
 padding: 20px 25px;
 }

 .preview-text {
 font-size: 14px;
 }

 .bg-column {
 flex: 100%;
 }

 .setting-row {
 flex-direction: column;
 align-items: flex-start;
 }

 .setting-control {
 width: 100%;
 margin-top: 5px;
 }
 }
 </style>
</head>
<body>
 <div class="theme-switch" id="themeSwitch">
 <span class="theme-icon" id="themeIcon">
 <i class="fas fa-moon"></i>
 </span>
 </div>

 <h1>텍스트 → 이미지 변환기</h1>

 <div class="container">
 <div class="controls">
 <!-- 텍스트 입력 그룹 -->
 <div class="control-group">
 <h3>텍스트 입력</h3>
 <textarea id="userText" placeholder="이미지로 변환할 텍스트를 입력하세요."></textarea>
 <div style="margin-top: 10px; display: flex; justify-content: space-between; align-items: center;">
 <div>
 <label for="pageLength">페이지당 글자 수 (대략): </label>
 <input type="number" id="pageLength" value="300" min="50" max="1000">
 </div>
 </div>
 </div>

 <!-- 배경 설정 그룹 -->
 <div class="control-group">
 <h3>배경 설정</h3>
 <div class="tab-buttons">
 <button id="colorTab" class="tab-button active">단색 배경</button>
 <button id="imageTab" class="tab-button">이미지 배경</button>
 </div>

 <div class="bg-settings-container">
 <!-- 왼쪽 열: 배경 설정 -->
 <div class="bg-column">
 <!-- 단색 배경 설정 -->
 <div id="colorBgOptions">
 <div class="color-picker-container">
 <div id="colorPicker"></div>
 </div>
 <div style="margin-top: 10px;">
 <input type="text" id="hexColor" value="#FFDD00" style="width: 80px;">
 </div>
 </div>

 <!-- 이미지 배경 설정 -->
 <div id="imageBgOptions" style="display:none;">
 <label for="headerImage" class="file-label">이미지 파일 선택</label>
 <input type="file" id="headerImage" class="file-input" accept="image/*">
 <img id="imagePreview" src="#" alt="이미지 미리보기">
 </div>
 </div>
 </div>
 </div>

 <!-- 텍스트 스타일 설정 그룹 -->
 <div class="control-group">
 <h3>텍스트 스타일 설정</h3>

 <!-- 폰트 설정 -->
 <div class="setting-group">
 <h4>폰트 설정</h4>
 <div class="setting-row">
 <div class="setting-label">글꼴</div>
 <div class="setting-control">
 <select id="fontSelect">
 <option value="부크크명조">부크크명조</option>
 <option value="조선일보명조">조선일보명조</option>
 <option value="조선가는고딕">조선가는고딕</option>
 <option value="경기천년바탕">경기천년바탕</option>
 <option value="수트">수트</option>
 <option value="리디바탕">리디바탕</option>
 <option value="조선굴림체">조선굴림체</option>
 <option value="Noto Sans KR">노토 산스</option>
 <option value="Nanum Myeongjo">나눔 명조</option>
 <option value="Nanum Gothic">나눔 고딕</option>
 <option value="Malgun Gothic">맑은 고딕</option>
 </select>
 </div>
 </div>
 <div class="setting-row">
 <div class="setting-label">글자 크기</div>
 <div class="setting-control">
 <input type="range" id="fontSize" min="12" max="24" value="16">
 <span id="fontSizeValue">16px</span>
 </div>
 </div>
 </div>

 <!-- 텍스트 스타일 -->
 <div class="setting-group">
 <h4>텍스트 스타일</h4>
 <div class="setting-row">
 <div class="setting-label">텍스트 색상</div>
 <div class="setting-control">
 <input type="color" id="textColor" value="#000000">
 </div>
 </div>
 <div class="setting-row">
 <div class="setting-label">줄 간격</div>
 <div class="setting-control">
 <input type="range" id="lineHeight" min="1.2" max="2.5" step="0.1" value="1.8">
 <span id="lineHeightValue">1.8</span>
 </div>
 </div>
 <div class="setting-row">
 <div class="setting-label">자간</div>
 <div class="setting-control">
 <input type="range" id="letterSpacing" min="0" max="0.3" step="0.01" value="0">
 <span id="letterSpacingValue">0</span>
 </div>
 </div>
 <div class="setting-row">
 <div class="setting-label">텍스트 정렬</div>
 <div class="setting-control">
 <select id="textAlign">
 <option value="left">왼쪽 정렬</option>
 <option value="center">가운데 정렬</option>
 <option value="right">오른쪽 정렬</option>
 <option value="justify">양쪽 정렬</option>
 </select>
 </div>
 </div>
 </div>

 <!-- 텍스트 박스 설정 -->
 <div class="setting-group">
 <h4>텍스트 박스 설정</h4>
 <div class="setting-row">
 <div class="setting-label">박스 배경색</div>
 <div class="setting-control">
 <input type="color" id="boxBgColor" value="#FFFFFF">
 </div>
 </div>
 <div class="setting-row">
 <div class="setting-label">박스 투명도</div>
 <div class="setting-control">
 <input type="range" id="boxOpacity" min="0" max="1" step="0.1" value="1">
 <span id="boxOpacityValue">1</span>
 </div>
 </div>
 <div class="setting-row">
 <div class="setting-label">박스 너비 (%)</div>
 <div class="setting-control">
 <input type="range" id="boxWidth" min="50" max="95" value="80">
 <span id="boxWidthValue">80%</span>
 </div>
 </div>
 <div class="setting-row">
 <div class="setting-label">패딩 (px)</div>
 <div class="setting-control">
 <input type="range" id="boxPadding" min="10" max="60" value="30">
 <span id="boxPaddingValue">30px</span>
 </div>
 </div>
 </div>
 </div>
 </div>

 <button id="generateBtn" class="button">이미지 생성</button>

 <div class="preview-container" id="previewContainer">
 <!-- 여기에 미리보기 이미지가 슬라이더로 표시됩니다 -->
 </div>
 </div>

 <script>
 // 전역 변수 설정
 let colorPicker;
 let selectedBgType = 'color';
 let headerImageUrl = null;
 let currentSlide = 0;
 let totalSlides = 0;
 let isDarkMode = false;

 // 페이지 로드 후 초기화
 document.addEventListener('DOMContentLoaded', function() {
 initColorPicker();
 setupEventListeners();
 checkPreferredTheme();
 updateSettingValues();
 });

 // 설정값 업데이트 표시
 function updateSettingValues() {
 // 폰트 크기
 document.getElementById('fontSize').addEventListener('input', function() {
 document.getElementById('fontSizeValue').textContent = this.value + 'px';
 });

 // 줄 간격
 document.getElementById('lineHeight').addEventListener('input', function() {
 document.getElementById('lineHeightValue').textContent = this.value;
 });

 // 자간
 document.getElementById('letterSpacing').addEventListener('input', function() {
 document.getElementById('letterSpacingValue').textContent = this.value + 'em';
 });

 // 박스 투명도
 document.getElementById('boxOpacity').addEventListener('input', function() {
 document.getElementById('boxOpacityValue').textContent = this.value;
 });

 // 박스 너비
 document.getElementById('boxWidth').addEventListener('input', function() {
 document.getElementById('boxWidthValue').textContent = this.value + '%';
 });

 // 패딩
 document.getElementById('boxPadding').addEventListener('input', function() {
 document.getElementById('boxPaddingValue').textContent = this.value + 'px';
 });
 }

 // 사용자 테마 설정 확인
 function checkPreferredTheme() {
 if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
 toggleDarkMode();
 }
 }

 // 다크모드 토글
 function toggleDarkMode() {
 isDarkMode = !isDarkMode;
 document.body.setAttribute('data-theme', isDarkMode ? 'dark' : 'light');

 const themeIcon = document.getElementById('themeIcon');
 themeIcon.innerHTML = isDarkMode
 ? '<i class="fas fa-sun"></i>'
 : '<i class="fas fa-moon"></i>';

 // 색상 선택기 재초기화
 if (colorPicker) {
 const color = colorPicker.color.hexString;
 initColorPicker(color);
 }
 }

 // 색상 선택기 초기화
 function initColorPicker(initialColor = "#FFDD00") {
 const colorPickerElement = document.getElementById('colorPicker');
 if (colorPickerElement.firstChild) {
 colorPickerElement.innerHTML = '';
 }

 colorPicker = new iro.ColorPicker("#colorPicker", {
 width: 180,
 color: initialColor,
 borderWidth: 1,
 borderColor: isDarkMode ? "#444" : "#ccc",
 layout: [
 { component: iro.ui.Wheel }
 ]
 });

 // 색상 변경 시 이벤트
 colorPicker.on('color:change', function(color) {
 document.getElementById('hexColor').value = color.hexString;
 });

 // 헥스 입력 변경 시 이벤트
 document.getElementById('hexColor').addEventListener('input', function() {
 colorPicker.color.hexString = this.value;
 });
 }

 // 이벤트 리스너 설정
 function setupEventListeners() {
 // 탭 전환 이벤트
 document.getElementById('colorTab').addEventListener('click', function() {
 toggleTab('color');
 });

 document.getElementById('imageTab').addEventListener('click', function() {
 toggleTab('image');
 });

 // 이미지 파일 선택 이벤트
 document.getElementById('headerImage').addEventListener('change', function(e) {
 if (e.target.files && e.target.files[0]) {
 const reader = new FileReader();

 reader.onload = function(event) {
 headerImageUrl = event.target.result;
 const preview = document.getElementById('imagePreview');
 preview.src = headerImageUrl;
 preview.style.display = 'block';
 };

 reader.readAsDataURL(e.target.files[0]);
 }
 });

 // 이미지 생성 버튼 이벤트
 document.getElementById('generateBtn').addEventListener('click', generateImages);

 // 다크모드 토글 이벤트
 document.getElementById('themeSwitch').addEventListener('click', toggleDarkMode);
 }

 // 탭 전환 함수
 function toggleTab(tabType) {
 selectedBgType = tabType;

 if (tabType === 'color') {
 document.getElementById('colorTab').classList.add('active');
 document.getElementById('imageTab').classList.remove('active');
 document.getElementById('colorBgOptions').style.display = 'block';
 document.getElementById('imageBgOptions').style.display = 'none';
 } else {
 document.getElementById('colorTab').classList.remove('active');
 document.getElementById('imageTab').classList.add('active');
 document.getElementById('colorBgOptions').style.display = 'none';
 document.getElementById('imageBgOptions').style.display = 'block';
 }
 }

 // 슬라이더 이동 함수
 function moveSlider(direction) {
 const sliderContainer = document.querySelector('.slider-container');
 if (!sliderContainer) return;

 if (direction === 'next' && currentSlide < totalSlides - 1) {
 currentSlide++;
 } else if (direction === 'prev' && currentSlide > 0) {
 currentSlide--;
 }

 const scrollPosition = currentSlide * sliderContainer.clientWidth;
 sliderContainer.scrollTo({
 left: scrollPosition,
 behavior: 'smooth'
 });

 updateDots();
 }

 // 특정 슬라이드로 이동
 function goToSlide(index) {
 const sliderContainer = document.querySelector('.slider-container');
 if (!sliderContainer) return;

 currentSlide = index;
 const scrollPosition = currentSlide * sliderContainer.clientWidth;
 sliderContainer.scrollTo({
 left: scrollPosition,
 behavior: 'smooth'
 });

 updateDots();
 }

 // 슬라이더 닷 업데이트
 function updateDots() {
 const dots = document.querySelectorAll('.slider-dot');
 dots.forEach((dot, index) => {
 if (index === currentSlide) {
 dot.classList.add('active');
 } else {
 dot.classList.remove('active');
 }
 });
 }

 // 이미지 생성 함수
 function generateImages() {
 const text = document.getElementById('userText').value;
 const textColor = document.getElementById('textColor').value;
 const bgColor = document.getElementById('hexColor').value;
 const boxBgColor = document.getElementById('boxBgColor').value;
 const charLimit = parseInt(document.getElementById('pageLength').value);
 const boxOpacity = document.getElementById('boxOpacity').value;
 const boxWidth = document.getElementById('boxWidth').value;
 const boxPadding = document.getElementById('boxPadding').value;
 const selectedFont = document.getElementById('fontSelect').value;
 const fontSize = document.getElementById('fontSize').value;
 const lineHeight = document.getElementById('lineHeight').value;
 const letterSpacing = document.getElementById('letterSpacing').value;
 const textAlign = document.getElementById('textAlign').value;

 if (!text) {
 alert('텍스트를 입력해주세요.');
 return;
 }

 // 미리보기 컨테이너 초기화
 const previewContainer = document.getElementById('previewContainer');
 previewContainer.innerHTML = '';

 // 슬라이더 컨테이너 생성
 const sliderContainer = document.createElement('div');
 sliderContainer.className = 'slider-container';

 // 슬라이더 컨트롤 생성
 const sliderControls = document.createElement('div');
 sliderControls.className = 'slider-controls';
 sliderControls.innerHTML = `
 <button class="slider-arrow prev" onclick="moveSlider('prev')">
 <i class="fas fa-chevron-left"></i>
 </button>
 <button class="slider-arrow next" onclick="moveSlider('next')">
 <i class="fas fa-chevron-right"></i>
 </button>
 `;

 // 텍스트 분할
 const textChunks = splitText(text, charLimit);
 totalSlides = textChunks.length;
 currentSlide = 0;

 // 각 텍스트 조각에 대해 이미지 생성
 textChunks.forEach((chunk, index) => {
 const outputContainer = document.createElement('div');
 outputContainer.className = 'output-container';

 const imageElement = document.createElement('div');
 imageElement.className = 'image-preview';

 // 배경 설정
 if (selectedBgType === 'color') {
 imageElement.style.backgroundColor = bgColor;
 } else if (selectedBgType === 'image' && headerImageUrl) {
 const headerImg = document.createElement('img');
 headerImg.src = headerImageUrl;
 headerImg.className = 'header-image';
 imageElement.appendChild(headerImg);
 }

 // 텍스트 박스 생성
 const textBox = document.createElement('div');
 textBox.className = 'text-box';
 textBox.style.width = boxWidth + '%';
 textBox.style.opacity = boxOpacity;
 textBox.style.padding = `${boxPadding}px`;
 textBox.style.fontFamily = selectedFont + ', serif';
 textBox.style.backgroundColor = boxBgColor;

 // 텍스트 영역 생성
 const textElement = document.createElement('div');
 textElement.className = 'preview-text';
 textElement.innerHTML = chunk.replace(/\n/g, '<br>');
 textElement.style.color = textColor;
 textElement.style.fontSize = fontSize + 'px';
 textElement.style.lineHeight = lineHeight;
 textElement.style.letterSpacing = letterSpacing + 'em';
 textElement.style.textAlign = textAlign;

 // 요소 조합
 textBox.appendChild(textElement);
 imageElement.appendChild(textBox);
 outputContainer.appendChild(imageElement);

 // 다운로드 버튼 추가
 const downloadBtn = document.createElement('button');
 downloadBtn.className = 'button';
 downloadBtn.style.marginTop = '10px';
 downloadBtn.textContent = '이미지 다운로드';
 downloadBtn.onclick = function() {
 downloadImage(imageElement, index + 1);
 };

 outputContainer.appendChild(downloadBtn);
 sliderContainer.appendChild(outputContainer);
 });

 // 슬라이더 닷 생성
 const dotsContainer = document.createElement('div');
 dotsContainer.className = 'slider-dots';

 for (let i = 0; i < totalSlides; i++) {
 const dot = document.createElement('div');
 dot.className = i === 0 ? 'slider-dot active' : 'slider-dot';
 dot.onclick = function() {
 goToSlide(i);
 };
 dotsContainer.appendChild(dot);
 }

 // 컨테이너에 요소 추가
 previewContainer.appendChild(sliderControls);
 previewContainer.appendChild(sliderContainer);
 previewContainer.appendChild(dotsContainer);

 // 슬라이더 크기 조정 이벤트 추가
 window.addEventListener('resize', function() {
 goToSlide(currentSlide);
 });
 }

 // 텍스트 분할 함수
 function splitText(text, charLimit) {
 const chunks = [];
 const paragraphs = text.split('\n');
 let currentChunk = '';

 paragraphs.forEach(paragraph => {
 if (currentChunk.length + paragraph.length + 1 <= charLimit) {
 currentChunk += (currentChunk ? '\n' : '') + paragraph;
 } else {
 // 현재 문단이 너무 길면 추가 분할
 if (currentChunk) {
 chunks.push(currentChunk);
 currentChunk = '';
 }

 if (paragraph.length <= charLimit) {
 currentChunk = paragraph;
 } else {
 // 긴 문단 분할
 let remainingText = paragraph;
 while (remainingText.length > 0) {
 let chunkSize = Math.min(charLimit, remainingText.length);
 // 단어 경계에서 잘리지 않도록 조정
 if (chunkSize < remainingText.length) {
 // 마지막 공백 위치 찾기
 const lastSpacePos = remainingText.substring(0, chunkSize).lastIndexOf(' ');
 if (lastSpacePos > charLimit / 2) { // 적어도 절반 이상 채웠는지 확인
 chunkSize = lastSpacePos;
 }
 }

 chunks.push(remainingText.substring(0, chunkSize));
 remainingText = remainingText.substring(chunkSize).trim();

 if (remainingText && remainingText.length <= charLimit) {
 currentChunk = remainingText;
 remainingText = '';
 }
 }
 }
 }
 });

 if (currentChunk) {
 chunks.push(currentChunk);
 }

 return chunks;
 }

 // 이미지 다운로드 함수
 function downloadImage(element, pageNum) {
 html2canvas(element, {
 scale: 2, // 고해상도
 backgroundColor: null,
 useCORS: true, // 외부 이미지 허용
 allowTaint: true // 외부 이미지 허용
 }).then(canvas => {
 const link = document.createElement('a');
 link.download = `text-image-${String(pageNum).padStart(2, '0')}.png`;
 link.href = canvas.toDataURL('image/png');
 link.click();
 });
 }
 </script>
</body>
</html>
