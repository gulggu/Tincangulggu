<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>í…ìŠ¤íŠ¸ â†’ ì´ë¯¸ì§€ ë³€í™˜ê¸°</title>
    <script src="https://cdn.jsdelivr.net/npm/@jaames/iro@5"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            text-align: center;
            background-color: #f4f4f4;
        }
        #color-picker {
            margin: 20px auto;
        }
        canvas {
            border: 1px solid black;
            margin-top: 10px;
        }
    </style>
</head>
<body>

    <h1>í…ìŠ¤íŠ¸ â†’ ì´ë¯¸ì§€ ë³€í™˜ê¸°</h1>

    <!-- ìƒ‰ìƒ ì„ íƒê¸° -->
    <div id="color-picker"></div>
    <input type="hidden" id="selected-color">

    <!-- í…ìŠ¤íŠ¸ ì…ë ¥ -->
    <input type="text" id="user-text" placeholder="ì´ë¯¸ì§€ì— ë“¤ì–´ê°ˆ í…ìŠ¤íŠ¸">
    
    <!-- ë¯¸ë¦¬ë³´ê¸° ìº”ë²„ìŠ¤ -->
    <h3>ë¯¸ë¦¬ë³´ê¸°</h3>
    <canvas id="preview-canvas" width="800" height="400"></canvas>

    <!-- ì´ë¯¸ì§€ ìƒì„± ë²„íŠ¼ -->
    <button id="generate-btn">ì´ë¯¸ì§€ ìƒì„±</button>

    <!-- ìµœì¢… ì¶œë ¥ ìº”ë²„ìŠ¤ -->
    <h3>ìƒì„±ëœ ì´ë¯¸ì§€</h3>
    <canvas id="output-canvas" width="800" height="400"></canvas>
    
    <!-- ë‹¤ìš´ë¡œë“œ ë²„íŠ¼ -->
    <button id="download-btn">ì´ë¯¸ì§€ ë‹¤ìš´ë¡œë“œ</button>

    <script>
        // ğŸ”¹ RGBA ìƒ‰ìƒ ì„ íƒê¸° ì„¤ì •
        const colorPicker = new iro.ColorPicker("#color-picker", {
            width: 200,
            color: "rgba(255, 0, 0, 1)", // ê¸°ë³¸ ìƒ‰ìƒ (ë¹¨ê°•)
            layout: [
                { component: iro.ui.Wheel }, 
                { component: iro.ui.Slider, options: { sliderType: 'alpha' } } // ë¶ˆíˆ¬ëª…ë„ ì¡°ì ˆ ìŠ¬ë¼ì´ë”
            ]
        });

        // ì„ íƒëœ ìƒ‰ìƒì„ hidden inputì— ì €ì¥
        colorPicker.on("color:change", function(color) {
            document.getElementById("selected-color").value = color.rgbaString;
            updatePreview();
        });

        // ğŸ”¹ ë¯¸ë¦¬ë³´ê¸° ìº”ë²„ìŠ¤ ì„¤ì •
        const previewCanvas = document.getElementById("preview-canvas");
        const previewCtx = previewCanvas.getContext("2d");

        function updatePreview() {
            previewCtx.clearRect(0, 0, previewCanvas.width, previewCanvas.height);

            // ë°°ê²½ìƒ‰ ì„¤ì •
            const selectedColor = document.getElementById("selected-color").value || "white";
            previewCtx.fillStyle = selectedColor;
            previewCtx.fillRect(0, 0, previewCanvas.width, previewCanvas.height);

            // ì…ë ¥ëœ í…ìŠ¤íŠ¸ ê°€ì ¸ì˜¤ê¸°
            const userText = document.getElementById("user-text").value || "ë¯¸ë¦¬ë³´ê¸° í…ìŠ¤íŠ¸";
            
            // í…ìŠ¤íŠ¸ ìŠ¤íƒ€ì¼
            previewCtx.fillStyle = "black";
            previewCtx.font = "30px Arial";
            previewCtx.textAlign = "center";
            previewCtx.fillText(userText, previewCanvas.width / 2, previewCanvas.height / 2);
        }

        // ì…ë ¥ê°’ ë³€ê²½ ì‹œ ë¯¸ë¦¬ë³´ê¸° ì—…ë°ì´íŠ¸
        document.getElementById("user-text").addEventListener("input", updatePreview);

        // ğŸ”¹ ì´ë¯¸ì§€ ìƒì„± ë²„íŠ¼ ê¸°ëŠ¥
        document.getElementById("generate-btn").addEventListener("click", function() {
            const canvas = document.getElementById("output-canvas");
            const ctx = canvas.getContext("2d");

            // ìº”ë²„ìŠ¤ ì´ˆê¸°í™”
            ctx.clearRect(0, 0, canvas.width, canvas.height);

            // ë°°ê²½ìƒ‰ ì ìš©
            const selectedColor = document.getElementById("selected-color").value || "white";
            ctx.fillStyle = selectedColor;
            ctx.fillRect(0, 0, canvas.width, canvas.height);

            // í…ìŠ¤íŠ¸ ê°€ì ¸ì˜¤ê¸°
            const userText = document.getElementById("user-text").value || "ì¶œë ¥í•  í…ìŠ¤íŠ¸";

            // í…ìŠ¤íŠ¸ ìŠ¤íƒ€ì¼
            ctx.fillStyle = "black";
            ctx.font = "30px Arial";
            ctx.textAlign = "center";
            ctx.fillText(userText, canvas.width / 2, canvas.height / 2);
        });

        // ğŸ”¹ ì´ë¯¸ì§€ ë‹¤ìš´ë¡œë“œ ë²„íŠ¼ ê¸°ëŠ¥
        document.getElementById("download-btn").addEventListener("click", function() {
            const canvas = document.getElementById("output-canvas");
            const link = document.createElement("a");
            link.download = "generated_image.png";
            link.href = canvas.toDataURL();
            link.click();
        });

        // ì´ˆê¸° ë¯¸ë¦¬ë³´ê¸° ì„¤ì •
        updatePreview();
    </script>

</body>
</html>
